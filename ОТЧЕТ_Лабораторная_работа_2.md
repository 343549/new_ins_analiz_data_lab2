# ОТЧЕТ

## Лабораторная работа №2: Кластеризация данных (K-средних и DBSCAN)

---

**Выполнил:** Джафари Хоссаин

**Дисциплина:** Современные инструменты анализа данных (СИАД)

**Дата:** 2025

---

## Содержание

1. [Цель работы](#цель-работы)
2. [Краткое описание использованных методов кластеризации](#краткое-описание-использованных-методов-кластеризации)
3. [Описание процесса генерации данных и применения методов](#описание-процесса-генерации-данных-и-применения-методов)
4. [Визуализация результатов](#визуализация-результатов)
5. [Анализ результатов и сравнение эффективности методов](#анализ-результатов-и-сравнение-эффективности-методов)
6. [Выводы](#выводы)

---

## Цель работы

Целью данной лабораторной работы является изучение и практическое применение двух алгоритмов кластеризации данных:

1. **K-Means (K-средних)** — центроидный алгоритм кластеризации
2. **DBSCAN** — алгоритм кластеризации на основе плотности

Работа включает:
- Генерацию синтетических данных с известной структурой кластеров
- Применение алгоритмов к синтетическим данным для проверки их работоспособности
- Применение алгоритмов к реальному датасету (Clustering Penguins Species)
- Сравнение эффективности методов на разных типах данных
- Анализ влияния параметров на качество кластеризации

---

## Краткое описание использованных методов кластеризации

### 1. K-Means (K-средних)

**K-Means** — это итеративный центроидный алгоритм кластеризации, который разделяет данные на K кластеров.

**Алгоритм работы:**
1. Инициализация K центроидов (случайно или по специальному алгоритму)
2. Назначение каждой точки ближайшему центроиду
3. Пересчет позиций центроидов как среднее арифметическое точек в кластере
4. Повторение шагов 2-3 до сходимости (когда центроиды перестают изменяться)

**Особенности:**
- Требует заранее задать число кластеров K
- Предполагает сферическую форму кластеров
- Все точки обязательно распределяются по кластерам
- Быстро работает даже на больших данных
- Чувствителен к выбросам и начальной инициализации

**Метрики оценки:**
- **Инерция (inertia)**: сумма квадратов расстояний от точек до центроидов их кластеров (меньше = лучше)
- **Коэффициент силуэта (silhouette score)**: мера качества разделения кластеров (от -1 до 1, больше = лучше)

**Методы подбора оптимального K:**
- **Метод локтя (Elbow Method)**: анализ графика зависимости инерции от числа кластеров
- **Коэффициент силуэта**: выбор K с максимальным значением силуэта

### 2. DBSCAN (Density-Based Spatial Clustering of Applications with Noise)

**DBSCAN** — алгоритм кластеризации на основе плотности точек в пространстве.

**Основные понятия:**
- **Точка ядра (core point)**: точка, в окрестности которой (радиус eps) находится не менее min_samples точек
- **Граничная точка (border point)**: точка, которая находится в окрестности точки ядра, но сама не является точкой ядра
- **Точка шума (noise point)**: точка, которая не является ни точкой ядра, ни граничной точкой

**Алгоритм работы:**
1. Выбор произвольной непосещенной точки
2. Если точка является точкой ядра, формирование кластера из всех достижимых точек
3. Если точка не является точкой ядра, помечается как шум
4. Повторение до обработки всех точек

**Параметры:**
- **eps**: максимальное расстояние между точками одного кластера
- **min_samples**: минимальное число точек для формирования кластера

**Особенности:**
- Автоматически определяет число кластеров
- Может находить кластеры произвольной формы
- Устойчив к выбросам (помечает их как шум)
- Требует тщательного подбора параметров
- Чувствителен к масштабу признаков (необходимо масштабирование)
- Может не работать хорошо при разных плотностях кластеров

---

## Описание процесса генерации данных и применения методов

### 1. Синтетические данные (make_blobs)

#### Генерация данных

Синтетический датасет был сгенерирован с помощью функции `make_blobs` из библиотеки scikit-learn с следующими параметрами:
- **n_samples**: 1000 точек
- **n_features**: 2 признака (для удобной визуализации в 2D)
- **centers**: 4 кластера (согласно заданию)
- **cluster_std**: 1.0 (стандартное отклонение точек внутри кластеров)
- **random_state**: 42 (для воспроизводимости результатов)

Данный датасет имеет заранее известную структуру кластеров, что позволяет проверить качество работы алгоритмов кластеризации.

#### Применение K-Means

1. **Кластеризация с известным числом кластеров (K=4)**:
   - Применен алгоритм KMeans с n_clusters=4
   - Получены метки кластеров для каждой точки
   - Вычислены метрики: инерция и коэффициент силуэта

2. **Подбор оптимального числа кластеров**:
   - Проведен перебор значений K от 2 до 8
   - Для каждого K вычислены инерция и коэффициент силуэта
   - Построены графики метода локтя и зависимости силуэта от K
   - Определено оптимальное значение K=4

#### Применение DBSCAN

1. **Масштабирование данных**:
   - Применен StandardScaler для нормализации признаков
   - Это критично для DBSCAN, так как алгоритм использует евклидово расстояние

2. **Кластеризация с базовыми параметрами**:
   - eps = 0.3
   - min_samples = 5
   - Получены метки кластеров и точки шума (метка -1)
   - Вычислен коэффициент силуэта для найденных кластеров

### 2. Реальный датасет (Clustering Penguins Species)

#### Загрузка и предобработка данных

1. **Загрузка данных**:
   - Датасет загружен из файла `penguins.csv`
   - Размерность: 344 строки, 5 столбцов
   - Признаки: culmen_length_mm, culmen_depth_mm, flipper_length_mm, body_mass_g, sex

2. **Предобработка**:
   - Выбор только числовых признаков (4 признака)
   - Удаление строк с пропущенными значениями (2 пропуска)
   - Удаление аномальных значений (отрицательные, слишком большие)
   - Итоговая размерность: 340 строк, 4 признака

3. **Масштабирование**:
   - Применен StandardScaler для нормализации всех признаков
   - Критично для корректной работы алгоритмов, особенно DBSCAN

#### Применение K-Means

1. **Подбор оптимального числа кластеров**:
   - Проведен перебор значений K от 2 до 8
   - По методу локтя оптимально K=2 или K=3
   - По коэффициенту силуэта оптимально K=2 (силуэт = 0.532)
   - Выбрано K=3 для соответствия биологическому смыслу (3 вида пингвинов)

2. **Кластеризация с K=3**:
   - Применен алгоритм KMeans
   - Получено распределение: 131, 123, 86 точек по кластерам
   - Инерция: 373.93
   - Коэффициент силуэта: 0.451

#### Применение DBSCAN

1. **Кластеризация с базовыми параметрами**:
   - eps = 0.5
   - min_samples = 5
   - Найдено 4 кластера
   - Обнаружено 67 точек шума (19.7% от всех данных)
   - Коэффициент силуэта (без шума): 0.424

2. **Эксперименты с параметрами**:
   - Систематический перебор комбинаций:
     - eps: [0.3, 0.4, 0.5, 0.6, 0.7]
     - min_samples: [3, 5, 7, 10]
   - Для каждой комбинации вычислены:
     - Число кластеров
     - Число точек шума
     - Процент шума
   - Результаты визуализированы в виде тепловых карт

---

## Визуализация результатов

### Синтетические данные

#### 1. Исходные данные с истинными кластерами
- График рассеяния показывает 4 четко разделенных кластера
- Кластеры имеют сферическую форму и примерно одинаковый размер

#### 2. Результаты K-Means
- Визуализация показывает 4 кластера с центроидами (черные крестики)
- Центроиды расположены в центрах кластеров
- Инерция: 1948.73
- Коэффициент силуэта: 0.792

#### 3. Метод локтя и коэффициент силуэта для K-Means
- График метода локтя показывает резкое снижение инерции до K=4, затем замедление
- График силуэта показывает максимум при K=4 (силуэт = 0.792)
- Оба метода подтверждают оптимальность K=4

#### 4. Результаты DBSCAN
- Найдено 3 кластера (вместо истинных 4)
- Точки шума отмечены черным цветом
- Коэффициент силуэта: 0.738
- Некоторые кластеры объединились из-за близкого расположения

### Датасет Penguins

#### 1. Предварительный анализ
- Гистограммы распределений числовых признаков
- Матрица scatter plots для пар признаков
- Выявлены корреляции между признаками

#### 2. Результаты K-Means
- Визуализация в пространстве разных пар признаков
- 3 кластера с распределением: 131, 123, 86 точек
- Кластеры хорошо разделены в пространстве признаков

#### 3. Метод локтя и коэффициент силуэта для K-Means
- График показывает оптимальность K=2 по метрике силуэта (0.532)
- K=3 выбран для биологической интерпретируемости

#### 4. Результаты DBSCAN
- Найдено 4 кластера
- 67 точек шума (19.7%)
- Распределение по кластерам: 118, 15, 27, 113 точек
- Визуализация показывает кластеры и точки шума

#### 5. Эксперименты с параметрами DBSCAN
- Тепловая карта числа кластеров в зависимости от eps и min_samples
- Тепловая карта процента шума
- Позволяет выбрать оптимальные параметры

---

## Анализ результатов и сравнение эффективности методов

### Синтетические данные

#### K-Means

**Результаты:**
- Успешно разделил данные на 4 кластера (соответствует истинному числу)
- Инерция: 1948.73
- Коэффициент силуэта: 0.792 (отличный результат)
- Все точки распределены по кластерам

**Анализ:**
- K-Means показал отличные результаты на синтетических данных
- Метод локтя и коэффициент силуэта подтвердили оптимальность K=4
- Алгоритм хорошо работает со сферическими кластерами одинакового размера

#### DBSCAN

**Результаты:**
- Найдено 3 кластера (вместо истинных 4)
- Коэффициент силуэта: 0.738
- Некоторые кластеры объединились

**Анализ:**
- DBSCAN не смог точно восстановить истинную структуру
- Требуется более тщательный подбор параметров eps и min_samples
- Алгоритм чувствителен к близкому расположению кластеров

**Сравнение:**
- **K-Means превосходит DBSCAN** на синтетических данных со сферическими кластерами
- K-Means точнее восстанавливает истинную структуру
- DBSCAN требует больше настройки параметров

### Датасет Penguins

#### K-Means

**Результаты:**
- Оптимальное число кластеров: K=3 (соответствует 3 видам пингвинов)
- Инерция: 373.93
- Коэффициент силуэта: 0.451
- Распределение: 131, 123, 86 точек
- Все точки распределены по кластерам (нет шума)

**Анализ:**
- K-Means показал хорошие результаты
- Найденное число кластеров соответствует биологическому смыслу
- Кластеры хорошо разделены в пространстве признаков
- Метрика силуэта указывает на приемлемое качество

#### DBSCAN

**Результаты:**
- Найдено 4 кластера (при eps=0.5, min_samples=5)
- Коэффициент силуэта: 0.424
- 67 точек шума (19.7% от всех данных)
- Распределение: 118, 15, 27, 113 точек

**Анализ:**
- DBSCAN нашел больше кластеров, чем ожидалось
- Высокий процент шума (19.7%) может указывать на:
  - Неоптимальные параметры
  - Особенности структуры данных (разные плотности кластеров)
- Коэффициент силуэта ниже, чем у K-Means
- Неравномерное распределение по кластерам (один кластер содержит всего 15 точек)

**Сравнение:**

| Метрика | K-Means | DBSCAN |
|---------|---------|--------|
| Число кластеров | 3 | 4 |
| Коэффициент силуэта | 0.451 | 0.424 |
| Инерция | 373.93 | - |
| Точки шума | 0 (0%) | 67 (19.7%) |
| Соответствие ожидаемому числу кластеров | Да (3 вида) | Нет |

**Выводы по датасету Penguins:**
- **K-Means показал лучшие результаты** по метрике силуэта и интерпретируемости
- K-Means нашел ожидаемое число кластеров (3 вида пингвинов)
- DBSCAN требует более тщательной настройки параметров
- Высокий процент шума в DBSCAN снижает практическую применимость

### Общее сравнение методов

#### Преимущества K-Means:
1.  Простота использования (требует только число кластеров)
2.  Быстрая работа даже на больших данных
3.  Все точки распределяются по кластерам
4.  Хорошо работает со сферическими кластерами
5.  Показал лучшие результаты на обоих датасетах

#### Недостатки K-Means:
1.  Требует заранее задать число кластеров
2.  Не может находить кластеры произвольной формы
3.  Чувствителен к выбросам
4.  Предполагает сферические кластеры одинакового размера

#### Преимущества DBSCAN:
1.  Автоматически определяет число кластеров
2.  Может находить кластеры произвольной формы
3.  Устойчив к выбросам (помечает их как шум)
4.  Не требует предварительного задания числа кластеров

#### Недостатки DBSCAN:
1.  Требует тщательного подбора параметров (eps, min_samples)
2.  Чувствителен к масштабу признаков (необходимо масштабирование)
3.  Может не работать хорошо при разных плотностях кластеров
4.  Медленнее на больших данных
5.  Может помечать много точек как шум

### Рекомендации по выбору метода

**Используйте K-Means, если:**
- Известно или ожидается определенное число кластеров
- Данные имеют сферическую структуру
- Нужна быстрая кластеризация больших данных
- Все точки должны быть распределены по кластерам

**Используйте DBSCAN, если:**
- Число кластеров неизвестно
- Кластеры могут иметь произвольную форму
- Важно выявить выбросы
- Готовы потратить время на подбор параметров

---

## Выводы

1. **На синтетических данных:**
   - K-Means успешно восстановил истинную структуру (4 кластера) с высоким качеством (силуэт = 0.792)
   - DBSCAN показал менее точные результаты (3 кластера вместо 4), требуя более тщательной настройки параметров

2. **На датасете Penguins:**
   - K-Means показал лучшие результаты (силуэт = 0.451) и нашел ожидаемое число кластеров (3 вида пингвинов)
   - DBSCAN нашел 4 кластера с более низким качеством (силуэт = 0.424) и высоким процентом шума (19.7%)

3. **Общие выводы:**
   - Для данных с известной структурой и ожидаемым числом кластеров предпочтительнее **K-Means**
   - K-Means лучше подходит для сферических кластеров одинакового размера
   - DBSCAN полезен для автоматического определения числа кластеров и выявления выбросов, но требует тщательной настройки
   - Оба метода требуют предобработки данных (масштабирование) для корректной работы

4. **Практические рекомендации:**
   - При работе с реальными данными рекомендуется использовать оба метода и сравнивать результаты
   - Для K-Means важно правильно подобрать число кластеров с помощью метода локтя и коэффициента силуэта
   - Для DBSCAN необходимо провести систематический перебор параметров для выбора оптимальных значений
   - Масштабирование данных критично для обоих методов, особенно для DBSCAN

---

**Работа выполнена индивидуально.**

**Дата выполнения:** 2025

